# ğŸ¦º å‚å•† SDK é…ç½®

:::tip{title="ğŸ’¡ å°æç¤º"}

 - ç©¿å±±ç”²åŸºç¡€é…ç½®å·²åŒ…å«åœ¨æ’ä»¶å†…ï¼Œå¹¿ç‚¹é€šã€ç™¾åº¦ã€å¿«æ‰‹ç­‰éœ€è¦æŒ‰éœ€å¯¼å…¥é…ç½®
 - ä¸‹é¢ä»¥`å¹¿ç‚¹é€š`ä¸ºä¾‹ï¼Œæ¯å¢åŠ ä¸€ä¸ªå‚å•†éƒ½å¿…é¡»é‡å¤å¦‚ä¸‹çš„æ­¥éª¤ï¼Œå¦åˆ™å¯èƒ½å‡ºç°å¹¿å‘ŠåŠ è½½å¼‚å¸¸ç­‰æƒ…å†µ
 - Pro ç‰ˆå®¢æˆ·ï¼Œå¦‚ SDK ä¸‹è½½å’Œé…ç½®æœ‰é—®é¢˜éšæ—¶è”ç³»æˆ‘ï¼Œæä¾›é›†æˆæŒ‡å¯¼æ”¯æŒ
 - æœ€æ–°ç‰ˆæœ¬ SDK è¯·å‚è€ƒæ’ä»¶åŒ…ä¸­é™„å¸¦çš„ç¤ºä¾‹ `example` ä¸­çš„é…ç½®

:::

## Android é…ç½®

- [å®˜æ–¹æ–‡æ¡£](https://www.csjplatform.com/union/media/union/download/detail?id=142&docId=27562&osType=android)

### å¼•å…¥ä¾èµ–

æ·»åŠ å¯¹åº”å‚å•†çš„ `Adapter` å’Œ `SDK` 

```gradle title="example/android/app/build.gradle"
dependencies {
    //GroMore_sdk adapter
    implementation "com.pangle.cn:mediation-gdt-adapter:xxx" //gdt adapter
    implementation "com.qq.e.union:union:xxx"// å¹¿ç‚¹é€šå¹¿å‘Š SDK
    implementation "com.pangle.cn:mediation-ks-adapter:xxx"//ks adapter
    implementation files('libs/kssdk-ad-xxx.aar')// å¿«æ‰‹å¹¿å‘Š SDK
    // è¿™é‡Œé€šè¿‡è¿œç¨‹ä»“åº“å¯¼å…¥ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§å®˜æ–¹ç¤ºä¾‹ä¸­çš„ `aar` å¯¼å…¥ä¾èµ–
}
```

### æ·»åŠ é…ç½®

> æœ¬æ’ä»¶å·²å°†åŸºç¡€é…ç½®å†…ç½®ï¼Œå¤§å¹…ç®€åŒ–äº†ç¹ççš„é…ç½®æµç¨‹ï¼Œè¿™é‡Œåªéœ€è¦æ·»åŠ å‚å•†ç‰¹æœ‰çš„é…ç½®å³å¯

```xml title="example/android/app/src/main/AndroidManifest.xml"
<!-- GDT start================== -->
<!-- targetSDKVersion >= 24æ—¶æ‰éœ€è¦æ·»åŠ è¿™ä¸ªproviderã€‚providerçš„authoritieså±æ€§çš„å€¼ä¸º${applicationId}.fileproviderï¼Œè¯·å¼€å‘è€…æ ¹æ®è‡ªå·±çš„${applicationId}æ¥è®¾ç½®è¿™ä¸ªå€¼ï¼Œä¾‹å¦‚æœ¬ä¾‹ä¸­applicationIdä¸º"com.qq.e.union.demo"ã€‚ -->
<provider
    android:name="com.qq.e.comm.GDTFileProvider"
    android:authorities="${applicationId}.gdt.fileprovider"
    android:exported="false"
    android:grantUriPermissions="true">
    <meta-data
        android:name="android.support.FILE_PROVIDER_PATHS"
        android:resource="@xml/gdt_file_path" />
</provider>

<activity
    android:name="com.qq.e.ads.PortraitADActivity"
    android:configChanges="keyboard|keyboardHidden|orientation|screenSize"
    android:screenOrientation="portrait" />
<activity
    android:name="com.qq.e.ads.LandscapeADActivity"
    android:configChanges="keyboard|keyboardHidden|orientation|screenSize"
    android:screenOrientation="landscape"
    tools:replace="android:screenOrientation" />

<!-- å£°æ˜SDKæ‰€éœ€è¦çš„ç»„ä»¶ -->
<service
    android:name="com.qq.e.comm.DownloadService"
    android:exported="false" />
<!-- è¯·å¼€å‘è€…æ³¨æ„å­—æ¯çš„å¤§å°å†™ï¼ŒADActivityï¼Œè€Œä¸æ˜¯AdActivity -->

<activity
    android:name="com.qq.e.ads.ADActivity"
    android:configChanges="keyboard|keyboardHidden|orientation|screenSize" />
<!-- GDT end================== -->

<!-- å…¶ä»–å¹¿å‘Šé…ç½®å‚è€ƒå®˜æ–¹æ–‡æ¡£æ·»åŠ å³å¯================== -->	
```

### æƒé™è¯·æ±‚

> å¿…è¦æƒé™å·²æ·»åŠ ï¼Œå…¶ä»–æƒé™`å‚è€ƒç¤ºä¾‹`å’Œ`å®˜æ–¹æ–‡æ¡£`é…Œæƒ…æ·»åŠ å³å¯ã€‚

```dart title="example/pages/home_page.dart"
bool result = await FlutterGromoreAds.requestPermissionIfNecessary;
```

## iOS é…ç½®

- [å®˜æ–¹æ–‡æ¡£](https://www.csjplatform.com/union/media/union/download/detail?id=143&docId=27487&osType=ios)

### å¼•å…¥ä¾èµ–

ä¿®æ”¹ `ios/Podfile` å¼•å…¥å‚å•† `SDK`

```ruby {3,4,6,7,8} title="example/ios/Podfile"
target 'Runner' do
  # å¹¿ç‚¹é€š/ä¼˜é‡æ±‡
  pod 'CSJMGdtAdapter', 'xxx'
  pod 'GDTMobSDK','xxx'
  # å¿«æ‰‹
  pod 'CSJMKsAdapter', 'xxx'
  pod 'KSAdSDK', '3.3.65.0'
  # è¿™é‡Œå¿«æ‰‹ SDK ä¸€å®šè¦ç”¨ '3.3.65.0' åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œä¸ç„¶ iOS éšç§æ¸…å•æ— æ³•é€šè¿‡
  # å…¶ä»–å‚å•†æŒ‰éœ€æ±‚æ·»åŠ 
```

### æ·»åŠ é…ç½®
```xml title="example/ios/Runner/Info.plist"
<key>NSAppTransportSecurity</key>
<dict>
    <key>NSAllowsArbitraryLoads</key>
    <true/>
</dict>
<key>NSUserTrackingUsageDescription</key>
<string>ä¸ºäº†å‘æ‚¨æä¾›æ›´ä¼˜è´¨ã€å®‰å…¨çš„ä¸ªæ€§åŒ–æœåŠ¡åŠå†…å®¹ï¼Œéœ€è¦æ‚¨å…è®¸ä½¿ç”¨ç›¸å…³æƒé™</string>
```

### ATT æˆæƒ
æ­¤æ­¥éª¤å¿…é¡»è¦åšï¼Œä¸ç„¶ä¸Šæ¶å®¡æ ¸æ—¶å€™ä¼šè¢«æ‹’ç»ã€‚ä»¥å¾€å¹¿å‘Šå½’å› ä¾èµ–äºIDFAã€‚ä»iOS 14å¼€å§‹ï¼Œåªæœ‰åœ¨è·å¾—ç”¨æˆ·æ˜ç¡®è®¸å¯çš„å‰æä¸‹ï¼Œåº”ç”¨æ‰å¯ä»¥è®¿é—®ç”¨æˆ·çš„IDFAæ•°æ®å¹¶å‘ç”¨æˆ·æŠ•æ”¾å®šå‘å¹¿å‘Šã€‚

```dart title="example/pages/home_page.dart"
bool result = await FlutterGromoreAds.requestIDFA;
```

### éšç§æ¸…å•æ–‡ä»¶

- è‹¹æœä» 2024 å¹´ 5 æœˆ 1 æ—¥å¼€å§‹ï¼Œä¸Šä¼ æˆ–æ›´æ–°åº”ç”¨è¦æ±‚æœ‰æ•ˆçš„éšç§æ¸…å•æ–‡ä»¶ç”³æ˜ï¼Œå…·ä½“æŸ¥çœ‹è¿™ä¸ªå®˜æ–¹æ–‡æ¡£[ã€ŠApple-éšç§æ¸…å•æ–‡ä»¶ã€‹](https://developer.apple.com/documentation/bundleresources/privacy_manifest_files)
- å¦‚æœæ²¡æœ‰é…ç½®è¿‡éšç§æ¸…å•æ–‡ä»¶ï¼Œå»ºè®®ç›´æ¥å°† `example/ios/Runner/PrivacyInfo.xcprivacy` å¤åˆ¶åˆ°ä½ çš„é¡¹ç›®ä¸­
- å¦‚æœå·²ç»é…ç½®è¿‡ï¼Œå°±éœ€è¦æ‰‹åŠ¨åˆå¹¶ä¸€ä¸‹ï¼Œå› ä¸ºå¾ˆå¤šéƒ½æ˜¯ç›¸ä¼¼çš„å†…å®¹

``` xml title="example/ios/Runner/PrivacyInfo.xcprivacy"
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<!--
   PrivacyInfo.xcprivacy
   Runner

   Created by zero on 2024/7/4.
   Copyright (c) 2024 FlutterAds. All rights reserved.
-->
<plist version="1.0">
<dict>
	<key>NSPrivacyCollectedDataTypes</key>
	<array>
		<dict>
			<key>NSPrivacyCollectedDataType</key>
			<string>NSPrivacyCollectedDataTypeDeviceID</string>
			<key>NSPrivacyCollectedDataTypeLinked</key>
			<false/>
			<key>NSPrivacyCollectedDataTypeTracking</key>
			<true/>
			<key>NSPrivacyCollectedDataTypePurposes</key>
			<array>
				<string>NSPrivacyCollectedDataTypePurposeThirdPartyAdvertising</string>
			</array>
		</dict>
		<dict>
			<key>NSPrivacyCollectedDataType</key>
			<string>NSPrivacyCollectedDataTypePerformanceData</string>
			<key>NSPrivacyCollectedDataTypeLinked</key>
			<false/>
			<key>NSPrivacyCollectedDataTypeTracking</key>
			<false/>
			<key>NSPrivacyCollectedDataTypePurposes</key>
			<array>
				<string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
			</array>
		</dict>
	</array>
	<key>NSPrivacyAccessedAPITypes</key>
	<array>
		<dict>
			<key>NSPrivacyAccessedAPIType</key>
			<string>NSPrivacyAccessedAPICategorySystemBootTime</string>
			<key>NSPrivacyAccessedAPITypeReasons</key>
			<array>
				<string>35F9.1</string>
			</array>
		</dict>
		<dict>
			<key>NSPrivacyAccessedAPIType</key>
			<string>NSPrivacyAccessedAPICategoryFileTimestamp</string>
			<key>NSPrivacyAccessedAPITypeReasons</key>
			<array>
				<string>C617.1</string>
			</array>
		</dict>
		<dict>
			<key>NSPrivacyAccessedAPIType</key>
			<string>NSPrivacyAccessedAPICategoryDiskSpace</string>
			<key>NSPrivacyAccessedAPITypeReasons</key>
			<array>
				<string>7D9E.1</string>
				<string>E174.1</string>
			</array>
		</dict>
		<dict>
			<key>NSPrivacyAccessedAPIType</key>
			<string>NSPrivacyAccessedAPICategoryUserDefaults</string>
			<key>NSPrivacyAccessedAPITypeReasons</key>
			<array>
				<string>CA92.1</string>
			</array>
		</dict>
	</array>
</dict>
</plist>
```

### å¸¸è§é—®é¢˜

:::tip {title="Undefined symbol: _OBJC_CLASS_$_ABUSDKConfig"}

- æŒ‰ç…§ä¸Šæ–¹ã€iOS å¼•å…¥ä¾èµ–ã€‘æˆ–ç¤ºä¾‹ä¸­çš„å¼•å…¥å‚å•†ä¾èµ–å³å¯è§£å†³

:::

:::tip {title="ShrinkProtoResourcesAction ParseError at [row,col]:[1,1]"}

æ·»åŠ ä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯ï¼Œå‚è€ƒç¤ºä¾‹ä¸­ `example/android/gradle.properties`

```dart title="example/android/gradle.properties"
android.enableNewResourceShrinker=false
```
:::